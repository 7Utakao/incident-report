import{_ as Y}from"./CUyEECmc.js";import{v as z,e as A,i as $,q as T,r as _,f as Q,g as ee,z as te,A as ae,c as S,o as D,a as h,M as re,k as V,m as N,h as m,b as d,w as I,d as C,D as R,S as P,t as oe,O as se,E as L,H as ne}from"./BBGXoVXL.js";import{u as le}from"./Dzv0W22B.js";import{r as K}from"./CdsG3Y99.js";import{i as ie,a as F,k as ue,o as w,A as B,e as y,m as M,l as de,b as E,f as Z,x as pe,N as W,_ as J,p as ce,n as ve,d as me,q as fe,r as he,h as ge,u as xe,v as ye,O as be}from"./CJ8rfh6T.js";function we({container:o,accept:l,walk:b,enabled:u}){z(()=>{let g=o.value;if(!g||u!==void 0&&!u.value)return;let i=ie(o);if(!i)return;let e=Object.assign(a=>l(a),{acceptNode:l}),r=i.createTreeWalker(g,NodeFilter.SHOW_ELEMENT,e,!1);for(;r.nextNode();)b(r.currentNode)})}var ke=(o=>(o[o.Open=0]="Open",o[o.Closed=1]="Closed",o))(ke||{}),Ie=(o=>(o[o.Pointer=0]="Pointer",o[o.Other=1]="Other",o))(Ie||{});function De(o){requestAnimationFrame(()=>requestAnimationFrame(o))}let G=Symbol("MenuContext");function j(o){let l=ae(G,null);if(l===null){let b=new Error(`<${o} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(b,j),b}return l}let Me=A({name:"Menu",props:{as:{type:[Object,String],default:"template"}},setup(o,{slots:l,attrs:b}){let u=_(1),g=_(null),i=_(null),e=_([]),r=_(""),a=_(null),v=_(1);function x(t=n=>n){let n=a.value!==null?e.value[a.value]:null,s=be(t(e.value.slice()),k=>w(k.dataRef.domRef)),c=n?s.indexOf(n):null;return c===-1&&(c=null),{items:s,activeItemIndex:c}}let p={menuState:u,buttonRef:g,itemsRef:i,items:e,searchQuery:r,activeItemIndex:a,activationTrigger:v,closeMenu:()=>{u.value=1,a.value=null},openMenu:()=>u.value=0,goToItem(t,n,s){let c=x(),k=ye(t===M.Specific?{focus:M.Specific,id:n}:{focus:t},{resolveItems:()=>c.items,resolveActiveIndex:()=>c.activeItemIndex,resolveId:f=>f.id,resolveDisabled:f=>f.dataRef.disabled});r.value="",a.value=k,v.value=s??1,e.value=c.items},search(t){let n=r.value!==""?0:1;r.value+=t.toLowerCase();let s=(a.value!==null?e.value.slice(a.value+n).concat(e.value.slice(0,a.value+n)):e.value).find(k=>k.dataRef.textValue.startsWith(r.value)&&!k.dataRef.disabled),c=s?e.value.indexOf(s):-1;c===-1||c===a.value||(a.value=c,v.value=1)},clearSearch(){r.value=""},registerItem(t,n){let s=x(c=>[...c,{id:t,dataRef:n}]);e.value=s.items,a.value=s.activeItemIndex,v.value=1},unregisterItem(t){let n=x(s=>{let c=s.findIndex(k=>k.id===t);return c!==-1&&s.splice(c,1),s});e.value=n.items,a.value=n.activeItemIndex,v.value=1}};return me([g,i],(t,n)=>{var s;p.closeMenu(),fe(n,he.Loose)||(t.preventDefault(),(s=w(g))==null||s.focus())},$(()=>u.value===0)),te(G,p),ge($(()=>xe(u.value,{0:E.Open,1:E.Closed}))),()=>{let t={open:u.value===0,close:p.closeMenu};return B({ourProps:{},theirProps:o,slot:t,slots:l,attrs:b,name:"Menu"})}}}),_e=A({name:"MenuButton",props:{disabled:{type:Boolean,default:!1},as:{type:[Object,String],default:"button"},id:{type:String,default:null}},setup(o,{attrs:l,slots:b,expose:u}){var g;let i=(g=o.id)!=null?g:`headlessui-menu-button-${F()}`,e=j("MenuButton");u({el:e.buttonRef,$el:e.buttonRef});function r(p){switch(p.key){case y.Space:case y.Enter:case y.ArrowDown:p.preventDefault(),p.stopPropagation(),e.openMenu(),T(()=>{var t;(t=w(e.itemsRef))==null||t.focus({preventScroll:!0}),e.goToItem(M.First)});break;case y.ArrowUp:p.preventDefault(),p.stopPropagation(),e.openMenu(),T(()=>{var t;(t=w(e.itemsRef))==null||t.focus({preventScroll:!0}),e.goToItem(M.Last)});break}}function a(p){switch(p.key){case y.Space:p.preventDefault();break}}function v(p){o.disabled||(e.menuState.value===0?(e.closeMenu(),T(()=>{var t;return(t=w(e.buttonRef))==null?void 0:t.focus({preventScroll:!0})})):(p.preventDefault(),e.openMenu(),De(()=>{var t;return(t=w(e.itemsRef))==null?void 0:t.focus({preventScroll:!0})})))}let x=ue($(()=>({as:o.as,type:l.type})),e.buttonRef);return()=>{var p;let t={open:e.menuState.value===0},{...n}=o,s={ref:e.buttonRef,id:i,type:x.value,"aria-haspopup":"menu","aria-controls":(p=w(e.itemsRef))==null?void 0:p.id,"aria-expanded":e.menuState.value===0,onKeydown:r,onKeyup:a,onClick:v};return B({ourProps:s,theirProps:n,slot:t,attrs:l,slots:b,name:"MenuButton"})}}}),Se=A({name:"MenuItems",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:null}},setup(o,{attrs:l,slots:b,expose:u}){var g;let i=(g=o.id)!=null?g:`headlessui-menu-items-${F()}`,e=j("MenuItems"),r=_(null);u({el:e.itemsRef,$el:e.itemsRef}),we({container:$(()=>w(e.itemsRef)),enabled:$(()=>e.menuState.value===0),accept(t){return t.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:t.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(t){t.setAttribute("role","none")}});function a(t){var n;switch(r.value&&clearTimeout(r.value),t.key){case y.Space:if(e.searchQuery.value!=="")return t.preventDefault(),t.stopPropagation(),e.search(t.key);case y.Enter:if(t.preventDefault(),t.stopPropagation(),e.activeItemIndex.value!==null){let s=e.items.value[e.activeItemIndex.value];(n=w(s.dataRef.domRef))==null||n.click()}e.closeMenu(),J(w(e.buttonRef));break;case y.ArrowDown:return t.preventDefault(),t.stopPropagation(),e.goToItem(M.Next);case y.ArrowUp:return t.preventDefault(),t.stopPropagation(),e.goToItem(M.Previous);case y.Home:case y.PageUp:return t.preventDefault(),t.stopPropagation(),e.goToItem(M.First);case y.End:case y.PageDown:return t.preventDefault(),t.stopPropagation(),e.goToItem(M.Last);case y.Escape:t.preventDefault(),t.stopPropagation(),e.closeMenu(),T(()=>{var s;return(s=w(e.buttonRef))==null?void 0:s.focus({preventScroll:!0})});break;case y.Tab:t.preventDefault(),t.stopPropagation(),e.closeMenu(),T(()=>pe(w(e.buttonRef),t.shiftKey?W.Previous:W.Next));break;default:t.key.length===1&&(e.search(t.key),r.value=setTimeout(()=>e.clearSearch(),350));break}}function v(t){switch(t.key){case y.Space:t.preventDefault();break}}let x=de(),p=$(()=>x!==null?(x.value&E.Open)===E.Open:e.menuState.value===0);return()=>{var t,n;let s={open:e.menuState.value===0},{...c}=o,k={"aria-activedescendant":e.activeItemIndex.value===null||(t=e.items.value[e.activeItemIndex.value])==null?void 0:t.id,"aria-labelledby":(n=w(e.buttonRef))==null?void 0:n.id,id:i,onKeydown:a,onKeyup:v,role:"menu",tabIndex:0,ref:e.itemsRef};return B({ourProps:k,theirProps:c,slot:s,attrs:l,slots:b,features:Z.RenderStrategy|Z.Static,visible:p.value,name:"MenuItems"})}}}),Re=A({name:"MenuItem",inheritAttrs:!1,props:{as:{type:[Object,String],default:"template"},disabled:{type:Boolean,default:!1},id:{type:String,default:null}},setup(o,{slots:l,attrs:b,expose:u}){var g;let i=(g=o.id)!=null?g:`headlessui-menu-item-${F()}`,e=j("MenuItem"),r=_(null);u({el:r,$el:r});let a=$(()=>e.activeItemIndex.value!==null?e.items.value[e.activeItemIndex.value].id===i:!1),v=ce(r),x=$(()=>({disabled:o.disabled,get textValue(){return v()},domRef:r}));Q(()=>e.registerItem(i,x)),ee(()=>e.unregisterItem(i)),z(()=>{e.menuState.value===0&&a.value&&e.activationTrigger.value!==0&&T(()=>{var f,O;return(O=(f=w(r))==null?void 0:f.scrollIntoView)==null?void 0:O.call(f,{block:"nearest"})})});function p(f){if(o.disabled)return f.preventDefault();e.closeMenu(),J(w(e.buttonRef))}function t(){if(o.disabled)return e.goToItem(M.Nothing);e.goToItem(M.Specific,i)}let n=ve();function s(f){n.update(f)}function c(f){n.wasMoved(f)&&(o.disabled||a.value||e.goToItem(M.Specific,i,0))}function k(f){n.wasMoved(f)&&(o.disabled||a.value&&e.goToItem(M.Nothing))}return()=>{let{disabled:f,...O}=o,X={active:a.value,disabled:f,close:e.closeMenu};return B({ourProps:{id:i,ref:r,role:"menuitem",tabIndex:f===!0?void 0:-1,"aria-disabled":f===!0?!0:void 0,onClick:p,onFocus:t,onPointerenter:s,onMouseenter:s,onPointermove:c,onMousemove:c,onPointerleave:k,onMouseleave:k},theirProps:{...b,...O},slot:X,attrs:b,slots:l,name:"MenuItem"})}}});function Ce(o,l){return D(),S("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[h("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"})])}function q(o,l){return D(),S("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[h("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"})])}function H(o,l){return D(),S("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[h("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"})])}function U(o,l){return D(),S("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[h("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4.5v15m7.5-7.5h-15"})])}function Pe(o,l){return D(),S("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[h("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"})])}function $e(o,l){return D(),S("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[h("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18 18 6M6 6l12 12"})])}const Te={class:"min-h-screen bg-gradient-to-b from-primary/40 via-white to-white"},Ae={key:0,class:"bg-sky-100 shadow-sm border-b border-primary/20 sticky top-0 z-50"},Oe={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},Ne={class:"flex items-center justify-between h-16"},Ee={class:"hidden lg:flex lg:items-center lg:space-x-8"},Be={class:"flex items-center space-x-4"},je={key:0,class:"hidden sm:block text-sm text-ink/70"},Fe={key:1,class:"relative"},Ve={class:"h-8 w-8 rounded-full bg-accent1 hover:bg-accent1/90 flex items-center justify-center transition-colors"},Le={class:"py-1"},Ke={key:0,class:"lg:hidden border-t border-primary/20 bg-sky-50"},Ze={class:"px-2 pt-2 pb-3 space-y-1"},Qe=A({__name:"app",setup(o){const{user:l,logout:b,isAuthenticated:u,checkAuthStatus:g}=le();re(),_(!1);const i=_(!1);console.log("layouts/app.vue - 初期認証状態:",u.value),console.log("layouts/app.vue - 初期ユーザー:",l.value);const e=async()=>{try{await b()}catch(r){console.error("Sign out error:",r)}};return V(u,(r,a)=>{console.log("layouts/app.vue - 認証状態変化:",{oldValue:a,newValue:r})},{immediate:!0}),V(l,(r,a)=>{console.log("layouts/app.vue - ユーザー情報変化:",{oldValue:a,newValue:r})},{immediate:!0}),Q(async()=>{console.log("layouts/app.vue - onMounted実行");{console.log("layouts/app.vue - 認証状態チェック開始");const r=await g();console.log("layouts/app.vue - 認証状態チェック結果:",r),console.log("layouts/app.vue - チェック後の認証状態:",u.value),console.log("layouts/app.vue - チェック後のユーザー:",l.value)}}),(r,a)=>{const v=Y;return D(),S("div",Te,[m(u)?(D(),S("header",Ae,[h("div",Oe,[h("div",Ne,[a[9]||(a[9]=h("div",{class:"flex items-center"},[h("h1",{class:"text-xl font-bold text-primaryDeep"},"報告システム")],-1)),h("nav",Ee,[d(v,{to:"/",class:R(["flex items-center px-3 py-2 text-sm font-medium rounded-md transition-colors",(r._.provides[P]||r.$route).path==="/"?"bg-primaryDeep/10 text-primaryDeep":"text-ink/70 hover:bg-primaryDeep/10 hover:text-primaryDeep"])},{default:I(()=>[d(m(H),{class:"mr-2 h-4 w-4"}),a[5]||(a[5]=C(" ホーム ",-1))]),_:1,__:[5]},8,["class"]),d(v,{to:"/reports",class:R(["flex items-center px-3 py-2 text-sm font-medium rounded-md transition-colors",(r._.provides[P]||r.$route).path.startsWith("/reports")?"bg-primaryDeep/10 text-primaryDeep":"text-ink/70 hover:bg-primaryDeep/10 hover:text-primaryDeep"])},{default:I(()=>[d(m(K),{class:"mr-2 h-4 w-4"}),a[6]||(a[6]=C(" 報告一覧 ",-1))]),_:1,__:[6]},8,["class"]),d(v,{to:"/reports/new",class:R(["flex items-center px-3 py-2 text-sm font-medium rounded-md transition-colors",(r._.provides[P]||r.$route).path==="/reports/new"?"bg-primaryDeep/10 text-primaryDeep":"text-ink/70 hover:bg-primaryDeep/10 hover:text-primaryDeep"])},{default:I(()=>[d(m(U),{class:"mr-2 h-4 w-4"}),a[7]||(a[7]=C(" 新規作成 ",-1))]),_:1,__:[7]},8,["class"]),d(v,{to:"/dashboard",class:R(["flex items-center px-3 py-2 text-sm font-medium rounded-md transition-colors",(r._.provides[P]||r.$route).path==="/dashboard"?"bg-primaryDeep/10 text-primaryDeep":"text-ink/70 hover:bg-primaryDeep/10 hover:text-primaryDeep"])},{default:I(()=>[d(m(q),{class:"mr-2 h-4 w-4"}),a[8]||(a[8]=C(" ダッシュボード ",-1))]),_:1,__:[8]},8,["class"])]),h("div",Be,[m(l)?(D(),S("div",je,oe(m(l).username),1)):N("",!0),m(u)?(D(),S("div",Fe,[d(m(Me),{as:"div",class:"relative"},{default:I(()=>[d(m(_e),{class:"flex items-center text-sm rounded-full focus:outline-none focus:ring-2 focus:ring-primary"},{default:I(()=>[h("div",Ve,[d(m(Pe),{class:"h-5 w-5 text-ink"})])]),_:1}),d(se,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:I(()=>[d(m(Se),{class:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:I(()=>[h("div",Le,[d(m(Re),null,{default:I(({active:x})=>[h("button",{onClick:e,class:R([x?"bg-gray-100":"","block w-full text-left px-4 py-2 text-sm text-gray-700"])}," ログアウト ",2)]),_:1})])]),_:1})]),_:1})]),_:1})])):N("",!0),h("button",{onClick:a[0]||(a[0]=x=>i.value=!i.value),class:"lg:hidden text-ink/60 hover:text-ink"},[i.value?(D(),L(m($e),{key:1,class:"h-6 w-6"})):(D(),L(m(Ce),{key:0,class:"h-6 w-6"}))])])]),i.value?(D(),S("div",Ke,[h("div",Ze,[d(v,{to:"/",onClick:a[1]||(a[1]=x=>i.value=!1),class:R(["flex items-center px-3 py-2 text-base font-medium rounded-md transition-colors",(r._.provides[P]||r.$route).path==="/"?"bg-primaryDeep/10 text-primaryDeep":"text-ink/70 hover:bg-primaryDeep/10 hover:text-primaryDeep"])},{default:I(()=>[d(m(H),{class:"mr-3 h-5 w-5"}),a[10]||(a[10]=C(" ホーム ",-1))]),_:1,__:[10]},8,["class"]),d(v,{to:"/reports",onClick:a[2]||(a[2]=x=>i.value=!1),class:R(["flex items-center px-3 py-2 text-base font-medium rounded-md transition-colors",(r._.provides[P]||r.$route).path.startsWith("/reports")?"bg-primaryDeep/10 text-primaryDeep":"text-ink/70 hover:bg-primaryDeep/10 hover:text-primaryDeep"])},{default:I(()=>[d(m(K),{class:"mr-3 h-5 w-5"}),a[11]||(a[11]=C(" 報告一覧 ",-1))]),_:1,__:[11]},8,["class"]),d(v,{to:"/reports/new",onClick:a[3]||(a[3]=x=>i.value=!1),class:R(["flex items-center px-3 py-2 text-base font-medium rounded-md transition-colors",(r._.provides[P]||r.$route).path==="/reports/new"?"bg-primaryDeep/10 text-primaryDeep":"text-ink/70 hover:bg-primaryDeep/10 hover:text-primaryDeep"])},{default:I(()=>[d(m(U),{class:"mr-3 h-5 w-5"}),a[12]||(a[12]=C(" 新規作成 ",-1))]),_:1,__:[12]},8,["class"]),d(v,{to:"/dashboard",onClick:a[4]||(a[4]=x=>i.value=!1),class:R(["flex items-center px-3 py-2 text-base font-medium rounded-md transition-colors",(r._.provides[P]||r.$route).path==="/dashboard"?"bg-primaryDeep/10 text-primaryDeep":"text-ink/70 hover:bg-primaryDeep/10 hover:text-primaryDeep"])},{default:I(()=>[d(m(q),{class:"mr-3 h-5 w-5"}),a[13]||(a[13]=C(" ダッシュボード ",-1))]),_:1,__:[13]},8,["class"])])])):N("",!0)])])):N("",!0),h("main",{class:R(m(u)?"p-6":"")},[ne(r.$slots,"default")],2)])}}});export{Qe as default};
